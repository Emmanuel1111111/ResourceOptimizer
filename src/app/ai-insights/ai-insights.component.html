<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Resource Insights</title>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.0/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body [class.dark-mode]="isDarkMode">

<div class="app-container row ">
  <!-- Enhanced Sidebar -->
  <nav class="modern-sidebar col-lg-2 col-md-2">
    <div class="sidebar-header">
      <div class="logo-container">
        <div class="logo-icon">
          <i class="bi bi-building" style="color: white;"></i>
        </div>
        <span class="logo-text" style="color: white;">ResourceAI</span>
      </div>
    </div>
    
    <div class="nav-menu">
      <a class="nav-item " href="#">
        <div class="nav-icon">
          <i class="bi bi-house-door" style="color: white;"></i>
        </div>
        <span class="nav-text" style="color: white;">Dashboard</span>
       
      </a>
      
      <a class="nav-item" href="#">
        <div class="nav-icon">
          <i class="bi bi-calendar-week"></i>
        </div>
        <span class="nav-text">Schedules</span>

      </a>
      
      <a class="nav-item active" href="#">
        <div class="nav-icon">
          <i class="bi bi-graph-up-arrow"></i>
        </div>
        <span class="nav-text">Analytics</span>
         <div class="nav-indicator"></div>
      </a>
      
      <a class="nav-item" href="#">
        <div class="nav-icon">
          <i class="bi bi-gear"></i>
        </div>
        <span class="nav-text">Settings</span>
      </a>
      
      <a class="nav-item" href="#">
        <div class="nav-icon">
          <i class="bi bi-person-circle"></i>
        </div>
        <span class="nav-text">Profile</span>
      </a>
    </div>
    
    <div class="sidebar-footer">
      <button class="theme-toggle-btn" (click)="toggleDarkMode()">
        <i class="bi" [ngClass]="isDarkMode ? 'bi-sun' : 'bi-moon'" style="color: white;"></i>
        <span style="color: white;">{{ isDarkMode ? 'Light' : 'Dark' }} Mode</span>
      </button>
    </div>
  </nav>

  <!-- Main Content Area -->
  <main class="main-content ">
    <!-- Enhanced Header -->
     <div class="col-md-10 col-lg-10">
    <div class="header-section">
      <div class="header-content" style="background-color:#ffffff; ">
        <div class="header-left">
          <div class="header-icon">
            <i class="bi bi-stars"></i>
          </div>
          <div class="header-text" >
            <h1 class="header-title" style="color: #1a2b5c;;" > Resource Insights</h1>
            <p class="header-subtitle" style="color: #1a2b5c;;">Smart analytics for optimal room utilization </p>
          </div>
        </div>
         
        <div class="header-right">
          <div *ngIf="loading" class="loading-indicator">
            <div class="loading-spinner"></div>
            <span class="loading-text">Analyzing data...</span>
          </div>
          
          
        </div>
      </div>
    </div>

    <!-- Enhanced Search Section -->
    <div class="search-section">
      <div class="search-container">
        <div class="search-wrapper" [class.focused]="searchFocused" style="background-color: #1a2b5c; color: white;">
          <div class="search-icon">
            <i class="bi bi-search"></i>
          </div>
          
          <input 
            #searchInput
            type="text" 
            class="search-input" 
            [(ngModel)]="roomId" 
            name="roomId" 
            border-outline="true"
            placeholder="Enter Room ID (e.g., SCB-SF1, MVBA-GF1)"
            [disabled]="loading"
            (focus)="onSearchFocus()"
            (blur)="onSearchBlur()"
            appearance="outline"
            autocomplete="off">
            
          
          <button 
            type="button" 
            class="search-btn" 
            (click)="fetchInsights()"
            [disabled]="loading || !roomId">
            <span *ngIf="!loading" class="btn-content">
              <i class="bi bi-lightning"></i>
              <span>Generate Insights</span>
            </span>
            <span *ngIf="loading" class="btn-loading">
              <div class="loading-spinner"></div>
              <span>Analyzing...</span>
            </span>
          </button>
          
          <!-- Search Suggestions -->
          <div class="search-suggestions" *ngIf="showSuggestions && searchFocused">
            <div 
              class="suggestion-item" 
              *ngFor="let suggestion of filteredSuggestions"
              (click)="selectSuggestion(suggestion)">
              <i class="bi bi-building"></i>
              <span>{{ suggestion }}</span>
            </div>
          </div>
        </div>
        
        <!-- Error Display -->
        <div *ngIf="error" class="error-message">
          <div class="error-icon">
            <i class="bi bi-exclamation-triangle"></i>
          </div>
          <span class="error-text">{{ error }}</span>
          <button class="error-close" (click)="error = ''">
            <i class="bi bi-x"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Enhanced Tabs -->
    <div class="tabs-section">
      <div class="tabs-container">
        <button 
          class="tab-button" 
          [class.active]="selectedTab === 0" 
          (click)="switchTab(0)">
          <div class="tab-icon">
            <i class="bi bi-graph-up"></i>
          </div>
          <div class="tab-content">
            <span class="tab-title">Current Analysis</span>
            <span class="tab-subtitle">Real-time utilization data</span>
          </div>
          <div class="tab-badge" *ngIf="hasCurrentData()">
            {{ current_results.length }}
          </div>
        </button>
        
        
      </div>
    </div>

    <!-- Tab Content -->
    <div class="content-section">
      <!-- Current Utilization Tab -->
      <div class="tab-pane" [class.active]="selectedTab === 0" [class.show-metrics]="showMetrics">
       
        <div *ngIf="!hasCurrentData() && !loading" class="empty-state">
          <div class="empty-icon">
            <i class="bi bi-graph-up-arrow"></i>
          </div>
          <h3 class="empty-title">No Current Data Available</h3>
          <p class="empty-subtitle">Enter a room ID and generate insights to view real-time utilization analytics</p>
          <div class="empty-suggestions">
            <span class="suggestion-label">Try these room IDs:</span>
            <div class="suggestion-chips">
              <button 
                class="suggestion-chip btn btn-primary" 
                *ngFor="let suggestion of searchSuggestions.slice(0, 3)"
                (click)="selectSuggestion(suggestion)">
                {{ suggestion }}
              </button>
            </div>
          </div>
        </div>

        <!-- Current Utilization Cards -->
        <div 
          *ngFor="let result of current_results; let i = index" 
          class="insight-card current-card"
          [style.animation-delay]="getCardAnimationDelay(i)">
          
          <!-- Enhanced Card Header -->
          <div class="card-header">
            <div class="header-left">
              <div class="room-info">
                <h3 class="room-title">
                  <i class="bi bi-building"></i>
                  {{ result.room_id }}
                </h3>
                
              </div>
            </div>
            
            <div class="header-right">
              <div class="status-indicators">
                <div class="status-badge" [ngClass]="getStatusClass(result.utilization_status)">
                  <i class="bi bi-circle-fill"></i>
                  {{ result.utilization_status }}
                </div>
                
                <div class="trend-indicator">
                  <i class="bi" [ngClass]="getTrendIcon(result.utilization_metrics.utilization_trend)"></i>
                  <span>{{ result.utilization_metrics.utilization_trend | titlecase }}</span>
                </div>
              </div>
            </div>
          </div>

          <div class="card-body">
            <!-- Enhanced Metrics Grid -->
            <div class="metrics-grid">
              <div 
                class="metric-card primary-metric"
                [style.animation-delay]="getMetricAnimationDelay(0)">
                <div class="metric-icon">
                  <i class="bi bi-speedometer2"></i>
                </div>
                <div class="metric-content">
                  <div class="metric-value">{{ result.utilization_metrics.average_utilization | number: '1.0-1' }}%</div>
                  <div class="metric-label">Average Utilization</div>
                </div>
                <div class="metric-trend positive">
                  <i class="bi bi-arrow-up"></i>
                </div>
              </div>
              
              <div 
                class="metric-card secondary-metric"
                [style.animation-delay]="getMetricAnimationDelay(1)">
                <div class="metric-icon">
                  <i class="bi bi-graph-up"></i>
                </div>
                <div class="metric-content">
                  <div class="metric-value">{{ result.utilization_metrics.peak_utilization | number: '1.0-1' }}%</div>
                  <div class="metric-label">Peak Utilization</div>
                </div>
              </div>
              
              <div 
                class="metric-card third-metric" 
                [style.animation-delay]="getMetricAnimationDelay(2)">
                <div class="metric-icon">
                  <i class="bi bi-clock"></i>
                </div>
                <div class="metric-content">
                  <div class="metric-value">{{ result.summary_insights.total_available_slots_per_week }}</div>
                  <div class="metric-label">Available Slots/Week</div>
                </div>
              </div>
              
             
            </div>

            <!-- Enhanced Utilization Progress -->
            <div class="utilization-section">
              <div class="section-header">
                <h4 class="section-title" style="color: white;">
                  <i class="bi bi-bar-chart"></i>
                  Utilization Overview
                </h4>
                <div class="utilization-range" style="color: whitesmoke;">
                  <span class="range-label" style="color: rgb(0, 0, 0);">Range:</span>
                  <span class="range-value" style="color: whitesmoke;">
                    {{ result.utilization_metrics.minimum_utilization | number: '1.0-1' }}% - 
                    {{ result.utilization_metrics.peak_utilization | number: '1.0-1' }}%
                  </span>
                </div>
              </div>
              
              <div class="progress-container">
                <div class="progress-track">
                  <div 
                    class="progress-fill" 
                    [style.width.%]="result.utilization_metrics.average_utilization"
                    [style.background]="'linear-gradient(90deg, ' + getUtilizationColor(result.utilization_metrics.average_utilization) + ' 0%, rgb(102, 51, 153) 100%)'">
                    <div class="progress-glow"></div>
                  </div>
                </div>
                <div class="progress-markers">
                  <span class="marker" style="left: 30%">30%</span>
                  <span class="marker" style="left: 70%">70%</span>
                </div>
              </div>
            </div>

            <!-- Distribution Cards -->
            <div class="distribution-grid">
              <div class="distribution-card optimal">
                <div class="card-icon">
                  <i class="bi bi-check-circle"></i>
                </div>
                <div class="card-content">
                  <div class="card-value">{{ result.utilization_distribution.days_optimal_range }}</div>
                  <div class="card-label">Optimal Days</div>
                  <div class="card-sublabel">(30-70% utilization)</div>
                </div>
              </div>
              
              <div class="distribution-card under-utilized">
                <div class="card-icon">
                  <i class="bi bi-arrow-down-circle"></i>
                </div>
                <div class="card-content">
                  <div class="card-value">{{ result.utilization_distribution.days_under_30_percent }}</div>
                  <div class="card-label">Under-Utilized</div>
                  <div class="card-sublabel">(&lt;30% utilization)</div>
                </div>
              </div>
              
              <div class="distribution-card over-utilized">
                <div class="card-icon">
                  <i class="bi bi-arrow-up-circle"></i>
                </div>
                <div class="card-content">
                  <div class="card-value">{{ result.utilization_distribution.days_over_70_percent }}</div>
                  <div class="card-label">Over-Utilized</div>
                  <div class="card-sublabel">(&gt;70% utilization)</div>
                </div>
              </div>
            </div>

            <!-- Enhanced Recommendations -->
            <div class="recommendations-section">
              <h4 class="section-title">
                <i class="bi bi-lightbulb"></i>
                Smart Recommendations
              </h4>
              
              <div class="recommendations-grid">
                <div class="recommendation-card priority-high">
                  <div class="recommendation-header">
                    <div class="recommendation-icon">
                      <i class="bi bi-exclamation-triangle"></i>
                    </div>
                    <div class="recommendation-title">Optimization Priority</div>
                    <div class="priority-badge high">High</div>
                  </div>
                  <div class="recommendation-content">
                    {{ result.utilization_tip }}
                  </div>
                </div>
                
                <div class="recommendation-card">
                  <div class="recommendation-header">
                    <div class="recommendation-icon">
                      <i class="bi bi-calendar-plus"></i>
                    </div>
                    <div class="recommendation-title">Scheduling Strategy</div>
                  </div>
                  <div class="recommendation-content">
                    <div *ngIf="result.scheduling_recommendations.immediate_opportunities.length > 0" class="strategy-section">
                      <strong class="strategy-label">Immediate Opportunities:</strong>
                      <ul class="opportunity-list">
                        <li *ngFor="let opp of result.scheduling_recommendations.immediate_opportunities">
                          <i class="bi bi-arrow-right"></i>
                          {{ opp }}
                        </li>
                      </ul>
                    </div>
                    
                    <div *ngIf="result.scheduling_recommendations.optimal_days_for_new_courses.length > 0" class="strategy-section">
                      <strong class="strategy-label">Optimal Days:</strong>
                      <div class="day-chips">
                        <span 
                          class="day-chip" 
                          *ngFor="let day of result.scheduling_recommendations.optimal_days_for_new_courses">
                          {{ day }}
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Enhanced Summary Insights -->
            <div class="summary-section">
              <h4 class="section-title">
                <i class="bi bi-info-circle"></i>
                Key Insights
              </h4>
              
              <div class="insights-grid">
                <div class="insight-item">
                  <div class="insight-icon">
                    <i class="bi bi-star"></i>
                  </div>
                  <div class="insight-content">
                    <div class="insight-label">Best Scheduling Day</div>
                    <div class="insight-value">{{ result.summary_insights.best_day_for_scheduling }}</div>
                  </div>
                </div>
                
                <div class="insight-item">
                  <div class="insight-icon">
                    <i class="bi bi-activity"></i>
                  </div>
                  <div class="insight-content">
                    <div class="insight-label">Busiest Day</div>
                    <div class="insight-value">{{ result.summary_insights.busiest_day }}</div>
                  </div>
                </div>
                
                <div class="insight-item">
                  <div class="insight-icon">
                    <i class="bi bi-clock-history"></i>
                  </div>
                  <div class="insight-content">
                    <div class="insight-label">Available Slots/Week</div>
                    <div class="insight-value">{{ result.summary_insights.total_available_slots_per_week }}</div>
                  </div>
                </div>
                
                
              </div>
            </div>

            <!-- Enhanced Daily Analysis Table -->
            <div class="table-section">
              <h4 class="section-title">
                <i class="bi bi-calendar-week"></i>
                Daily Schedule Analysis
              </h4>
              
              <div class="table-container">
                <table class="modern-table">
                  <thead>
                    <tr>
                      <th>
                        <i class="bi bi-calendar-day"></i>
                        Day
                      </th>
                      <th>
                        <i class="bi bi-clock"></i>
                        Free Timeslots
                      </th>
                      <th>
                        <i class="bi bi-percent"></i>
                        Utilization
                      </th>
                      <th>
                       
                        <i class="bi bi-star"></i>
                        Priority Slots
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let slot of result.daily_analysis; let i = index" 
                        [style.animation-delay]="(i * 0.1) + 's'">
                      <td class="day-cell">
                        <div class="day-indicator">
                          <span class="day-name">{{ slot.day }}</span>
                        </div>
                      </td>
                      <td class="timeslots-cell">
                        <div class="timeslot-chips" *ngIf="slot.free_timeslots && slot.free_timeslots.length > 0">
                          <span class="timeslot-chip" *ngFor="let timeslot of slot.free_timeslots">
                            {{ timeslot }}
                          </span>
                          
                        </div>
                        <span class="no-data" *ngIf="!slot.free_timeslots || slot.free_timeslots.length === 0">
                          None available
                        </span>
                      </td>
                      <td class="utilization-cell">
                        <div class="utilization-badge" 
                             [ngClass]="{'optimal': slot.utilization_percentage >= 30 && slot.utilization_percentage <= 70,
                                        'under': slot.utilization_percentage < 30,
                                        'over': slot.utilization_percentage > 70}">
                          <span class="percentage">{{ slot.utilization_percentage | number: '1.1-1' }}%</span>
                          <div class="mini-progress">
                            <div class="mini-fill" [style.width.%]="slot.utilization_percentage"></div>
                          </div>
                        </div>
                      </td>
                      
                      <td class="priority-cell">
                        <div class="priority-slots" *ngIf="slot.priority_scheduling_slots && slot.priority_scheduling_slots.length > 0">
                          <span class="priority-slot" *ngFor="let priority of slot.priority_scheduling_slots.slice(0, 2)">
                            {{ priority }}
                          </span>
                        </div>
                        <span class="no-data" *ngIf="!slot.priority_scheduling_slots || slot.priority_scheduling_slots.length === 0">
                          None
                        </span>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>


      
    </div>
    </div>

    
  </main>
</div>

</body>
</html>
